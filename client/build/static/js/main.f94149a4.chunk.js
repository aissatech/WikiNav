(this["webpackJsonpsearch-demo"]=this["webpackJsonpsearch-demo"]||[]).push([[0],{106:function(e,t,a){},111:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(18),c=a.n(r),i=a(16),s=a(29),o=a(8),l=a(14),u=a(66),p=a.n(u),h=a(20),d=a.n(h),b=a(30),g=a(26),m=a.n(g),j={getAll:function(){var e=Object(b.a)(d.a.mark((function e(t,a,n){var r,c,i,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=encodeURIComponent(n),c="".concat("https://wn-api-test.toolforge.org","/").concat(a,"/").concat(r,"/").concat(t),e.next=4,m.a.head(c);case 4:return i=e.sent,s=i.headers["total-count"],e.next=8,m.a.get("".concat(c,"?limit=").concat(s));case 8:return i=e.sent,e.abrupt("return",i.data.results);case 10:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()},f="https://wikimedia.org/api/rest_v1/metrics/pageviews/per-article",v={getMonthly:function(){var e=Object(b.a)(d.a.mark((function e(t,a){var n,r,c,i,s,o,l=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>2&&void 0!==l[2]?l[2]:1,r=l.length>3&&void 0!==l[3]?l[3]:2021,c=encodeURIComponent(a),i="".concat(f,"/").concat(t,".wikipedia/all-access/user/").concat(c,"/monthly/").concat(r,"010100/").concat(r,"123100"),e.next=6,m.a.get(i);case 6:return s=e.sent,o=s.data.items,e.abrupt("return",o[n-1].views);case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},O=a(31),x=a(58),w=a.n(x),_=a(3),y=function(e){var t=e.name,a=e.onChange,n=e.placeholder;return Object(_.jsx)("div",{className:w.a.languageSearch,children:Object(_.jsx)(O.a,{name:t,cacheOptions:!0,onChange:a,placeholder:n,options:[{value:"en",label:"en.wikipedia.org"},{value:"pt",label:"pt.wikipedia.org"}],noOptionsMessage:function(){return null},components:{DropdownIndicator:function(){return null},IndicatorSeparator:function(){return null}},maxMenuHeight:175,theme:function(e){return Object(o.a)(Object(o.a)({},e),{},{colors:Object(o.a)(Object(o.a)({},e.colors),{},{neutral50:"black"})})}})})},k=a(59),S=a(60),A=a.n(S),N=function(e){var t=e.name,a=e.language,r=e.onChange,c=e.placeholder,i=Object(n.useState)(""),s=Object(l.a)(i,2),u=s[0],p=s[1];return Object(_.jsx)("div",{className:A.a.titleSearch,children:Object(_.jsx)(k.a,{name:t,placeholder:c,cacheOptions:!0,getOptionLabel:function(e){return e.title},getOptionValue:function(e){return e.title.replaceAll(" ","_")},loadOptions:function(){var e="https://".concat(a,".wikipedia.org/w/api.php?action=query&list=prefixsearch&format=json&pssearch=").concat(u,"&origin=*");return fetch(e).then((function(e){return e.json()})).then((function(e){return e.query.prefixsearch}))},onInputChange:function(e){return p(e)},onChange:r,noOptionsMessage:function(){return"Enter one or more characters to get started."},components:{DropdownIndicator:function(){return null},IndicatorSeparator:function(){return null}},maxMenuHeight:175,theme:function(e){return Object(o.a)(Object(o.a)({},e),{},{colors:Object(o.a)(Object(o.a)({},e.colors),{},{neutral50:"black"})})}})})},T=a(35),C=a.n(T),F=a(39),P=a.n(F),z=function(e){var t=e.links,a=e.title,r=e.viewPercentage,c=Object(n.useState)(10),s=Object(l.a)(c,2),o=s[0],u=s[1],p=[{value:10,label:"top 10"},{value:20,label:"top 20"}],h=[],d=[],b=[Math.min(t.in.length,o),Math.min(t.out.length,o)],g=Object(i.a)(Array(b[0]).keys()).concat(Array(b[1]).fill(b[0])),m=Array(b[0]).fill(b[0]).concat(Object(i.a)(Array(b[1]).keys()).map((function(e){return b[0]+e+1})));return Object.keys(t).forEach((function(e,a){h=h.concat(t[e].slice(0,b[a]).map((function(e){return e.title}))),d=d.concat(t[e].slice(0,b[a]).map((function(e){return e.views})))})),h.splice(b[0],0,a.replaceAll("_"," ")),Object(_.jsxs)("div",{className:P.a.sankey,children:[Object(_.jsx)(O.a,{className:P.a.limit,options:p,onChange:function(e){return u(e.value)},defaultValue:p[0],isSearchable:!1}),Object(_.jsx)(C.a,{data:[{type:"sankey",orientation:"h",node:{pad:30,thickness:10,line:{width:0},label:h,color:"#0670de"},link:{source:g,target:m,value:d,color:"#edf6fc",customdata:r.in.slice(0,o).concat(r.out.slice(0,o)),hovertemplate:"<b>Source</b>: %{source.label}<br><b>Target</b>: %{target.label}<br><b>%{customdata}%</b> of <b>%{target.label}'s</b> views for the month"}}],layout:{autosize:!0,margin:{l:10,r:10,t:10,b:30},font:{size:10}},config:{displaylogo:!1,modeBarButtonsToRemove:["lasso2d","select2d","hoverClosestCartesian","hoverCompareCartesian"]},useResizeHandler:!0,style:{width:"100%",height:"100%"}})]})},M=a(61),B=a.n(M),I=function(e){var t=e.inlinks,a=function(e,t){return e+t.views},n=t.reduce(a,0),r=["other-search","other-empty","other-internal","other-other","Main_Page"],c=t.filter((function(e){return r.includes(e.title)}));c.push({title:"Articles",views:n-c.reduce(a,0)});var i=Array(c.length).fill("All Pageviews");c.unshift({title:"All Pageviews",views:n}),i.unshift("");var s=c.map((function(e){return e.title})),o=c.map((function(e){return e.views})),l=o.map((function(e){return(100*e/n).toFixed(2)}));return Object(_.jsx)("div",{className:B.a.treemap,children:Object(_.jsx)(C.a,{data:[{type:"treemap",branchvalues:"total",labels:s,values:o,parents:i,customdata:l,texttemplate:"<b>%{label}</b><br>%{percentParent}",hovertemplate:"<b>%{label}</b><br>Pageviews: %{value}<br>%{customdata}%<extra></extra>",marker:{colors:["#FFF","#0E4D92","0080FF","6593F5","73C2FB","588BAE"]}}],layout:{autosize:!0,margin:{l:10,r:10,t:30,b:30}},config:{displaylogo:!1,modeBarButtons:[["toImage"]]},useResizeHandler:!0,style:{width:"100%",height:"100%"}})})},R=a(62),D=a.n(R),E=(a(106),function(e){var t=e.links,a=e.viewPercentage,n=e.dir,r=e.tableTitle,c=t.slice(0,10),s=a.slice(0,10),o=c.slice(-1)[0].views,l=c[0].views,u=Math.min.apply(Math,Object(i.a)(s)),p=Math.max.apply(Math,Object(i.a)(s)),h=function(e,t,a,n){return"rgba(".concat(e,", ").concat(((t-a)/(n-a)||0).toFixed(1),")")},d="50, 166, 255",b=[{name:"in"===n?"Source":"Target",selector:"in"===n?"source":"target",sortable:!0,wrap:!0},{name:"Views",selector:"views",sortable:!0,conditionalCellStyles:[{when:function(){return!0},style:function(e){return{backgroundColor:h(d,e.views,o,l)}}}]},{name:"Percentage of Views",selector:"pov",sortable:!0,conditionalCellStyles:[{when:function(){return!0},style:function(e){return{backgroundColor:h(d,e.pov,u,p)}}}]}],g="in"===n?function(e,t){return{id:t,source:e.title.replaceAll("_"," "),views:e.views,pov:parseFloat(s[t])}}:function(e,t){return{id:t,target:e.title.replaceAll("_"," "),views:e.views,pov:parseFloat(s[t])}},m=c.map(g);return Object(_.jsx)(D.a,{title:r,columns:b,data:m})}),W=a(65),q=a.n(W),H=function(e){var t=e.children,a=e.className;return Object(_.jsx)("div",{className:"".concat(a," ").concat(q.a.instruction),children:t})},L=a(5),U=a.n(L),V=function(){var e=Object(n.useState)({title:"Chocolate",language:"en"}),t=Object(l.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)({in:null,out:null}),u=Object(l.a)(c,2),h=u[0],d=u[1],b=Object(n.useState)(!0),g=Object(l.a)(b,2),m=g[0],f=g[1],O=Object(n.useState)(!0),x=Object(l.a)(O,2),w=x[0],k=x[1],S=Object(n.useState)({in:null,out:null}),A=Object(l.a)(S,2),T=A[0],C=A[1],F=function(e,t){var n=t.name,c="language"===n?e.value:e.title.replaceAll(" ","_");a[n]!==c&&(r(Object(o.a)(Object(o.a)({},a),{},Object(s.a)({},n,c))),f(!0))};return Object(n.useEffect)((function(){Promise.allSettled([j.getAll("sources",a.language,a.title),j.getAll("destinations",a.language,a.title)]).then((function(e){var t=!1,a=["in","out"],n={in:[],out:[]};e.forEach((function(e,r){"fulfilled"===e.status&&(t=!0,n[a[r]]=e.value)})),t?(k(!1),d(n)):(k(!0),f(!1))}))}),[a]),Object(n.useEffect)((function(){var e,t;w||Promise.all([v.getMonthly(a.language,a.title)].concat(Object(i.a)(h.out.slice(0,20).map((function(e){var t=e.title;return v.getMonthly(a.language,t)}))))).then((function(a){e=h.in.slice(0,20).map((function(e){return(100*e.views/a[0]).toFixed(2)})),t=a.slice(1).map((function(e,t){return(100*h.out[t].views/e).toFixed(2)})),C({in:e,out:t}),f(!1)}))}),[h]),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("p",{className:U.a.topText,children:"Clickstream Analysis"}),Object(_.jsx)("div",{className:U.a.topBar,children:Object(_.jsxs)("div",{className:U.a.controlsWrapper,children:[Object(_.jsx)(y,{name:"language",placeholder:"en.wikipedia.org",onChange:F}),Object(_.jsx)(N,{name:"title",placeholder:"Chocolate",language:a.language,onChange:F})]})}),Object(_.jsxs)("div",{className:U.a.vizWrapper,children:[!m&&(w?Object(_.jsx)("div",{className:U.a.noData,children:"No data found for this title. Try another one."}):Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("div",{className:U.a.heading,children:"Visualizing Reader Navigation"}),Object(_.jsx)(z,{links:h,title:a.title,viewPercentage:T}),Object(_.jsx)("div",{}),Object(_.jsx)("div",{className:U.a.instructionWrapper,children:Object(_.jsxs)(H,{className:U.a.instruction,children:[Object(_.jsx)("strong",{children:"Reading the chart: "}),Object(_.jsx)("span",{children:"The chart shows common pathways to and from the selected title. The links between nodes represent the number of pageviews. Hovering over the nodes and links gives additional information to help contextualize these pageviews."})]})}),Object(_.jsx)("div",{className:U.a.heading,children:"Pageviews by Referrer"}),Object(_.jsx)(I,{inlinks:h.in}),Object(_.jsxs)(H,{className:U.a.instruction,children:[Object(_.jsx)("strong",{children:"Reading the chart: "}),Object(_.jsxs)("span",{children:["Incoming clickstream traffic is mapped to a set of \xa0",Object(_.jsx)("a",{href:"https://meta.wikimedia.org/wiki/Research:Wikipedia_clickstream#Data_Preparation",children:"referrers"}),". This chart shows the percentage of views each of these referrers directs to the selected title."]})]}),Object(_.jsx)("div",{className:U.a.heading,children:"Summary Tables"}),Object(_.jsxs)(H,{className:U.a.instruction,children:[Object(_.jsx)("strong",{children:"Reading the tables: "}),Object(_.jsx)("span",{children:"These tables summarize the visualizations above. The views and percentage of views columns double as heatmaps. The columns can be sorted by clicking on their labels."})]}),h.in.length&&Object(_.jsx)("div",{className:U.a.summaryTable,children:Object(_.jsx)(E,{title:a.title,links:h.in,viewPercentage:T.in,dir:"in",tableTitle:"Incoming Pageviews"})}),h.out.length&&Object(_.jsx)("div",{className:U.a.summaryTable,children:Object(_.jsx)(E,{className:U.a.destinationSummaryTable,title:a.title,links:h.out,viewPercentage:T.out,dir:"out",tableTitle:"Outgoing Pageviews"})})]})),Object(_.jsx)("div",{className:U.a.scaleLoader,children:Object(_.jsx)(p.a,{color:"#000",loading:m,size:150})})]})]})};c.a.render(Object(_.jsx)(V,{}),document.getElementById("root"))},39:function(e,t,a){e.exports={sankey:"Sankey_sankey__24cyW",limit:"Sankey_limit__1UfUX"}},5:function(e,t,a){e.exports={topText:"App_topText__4XB3f",heading:"App_heading__2nYdz",topBar:"App_topBar__aK-uF",controlsWrapper:"App_controlsWrapper__3qbr-",vizWrapper:"App_vizWrapper__F7ObS",scaleLoader:"App_scaleLoader__djHqD",summaryTable:"App_summaryTable___a3Gp",noData:"App_noData__9ngzR",instruction:"App_instruction__3UopB"}},58:function(e,t,a){e.exports={languageSearch:"LanguageSearch_languageSearch__3vEqn"}},60:function(e,t,a){e.exports={titleSearch:"TitleSearch_titleSearch__qfSJ1"}},61:function(e,t,a){e.exports={treemap:"TreeMap_treemap__Kwp5-"}},65:function(e,t,a){e.exports={instruction:"Instruction_instruction__2BnD0"}}},[[111,1,2]]]);